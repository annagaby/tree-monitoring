---
title: "tree_monitoring"
author: "Anna Calle"
date: "28/08/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Load necessary packages and read csv file
library(tidyverse)
library(plotly)
library(leaflet)
library(sf)
library(rgdal)
library(dplyr)
library(RColorBrewer)


tree_data <- read_csv("tree_monitoring.csv")

```


```{r}
# Pie chart with plotly

# More info in https://plot.ly/r/pie-charts/
# Note: find how to animate it

```

```{r}
sach_polygon <- st_read(dsn = ".", layer = "ref_area") 

```

```{r}
pal <- colorFactor(c("green", "red"), tree_data$Alive_or_Dead) 
        
        leaflet(data = tree_data)%>%
            addTiles() %>% 
            addCircles(lng = ~Longitude,
                       lat = ~Latitude,
                       weight = 3, radius=2.5, 
                       color= ~pal(Alive_or_Dead),
                       stroke = TRUE, fillOpacity = 0.8,
                       popup = paste("<strong>Tree ID</strong>:", tree_data$ID, "<br>",
                                     "<strong>Species:</strong>", tree_data$Species, "<br>",
                                     "<strong>Height:</strong>", tree_data$Height, " m" )) %>%
          addPolygons(data = sach_polygon) %>% 
            addLegend(pal = pal, values = ~Alive_or_Dead, opacity = 1, title = "Tree Survival") %>% 
            addMiniMap()
```

```{r}
pal <- colorFactor(c("green", "red"), tree_data$Alive_or_Dead) 
        
        leaflet(data = tree_data) %>%
          addTiles() %>% 
          addPolygons(data = sach_polygon) %>% 
            addCircles(data = tree_data,
                       lng = ~Longitude,
                       lat = ~Latitude,
                       weight = 3, radius=2.5, 
                       color= ~pal(Alive_or_Dead),
                       stroke = TRUE, fillOpacity = 0.8,
                       popup = paste("<strong>Tree ID</strong>:", tree_data$ID, "<br>",
                                     "<strong>Species:</strong>", tree_data$Species, "<br>",
                                     "<strong>Height:</strong>", tree_data$Height, " m" )) %>% 
            addLegend(pal = pal, values = ~Alive_or_Dead, opacity = 1, title = "Tree Survival") %>% 
            addMiniMap()
```

