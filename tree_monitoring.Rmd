---
title: "tree_monitoring"
author: "Anna Calle"
date: "28/08/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Load necessary packages and read csv file
library(tidyverse)
library(plotly)
library(leaflet)
library(sf)
library(dplyr)
library(RColorBrewer)


tree_data <- read_csv("tree_monitoring.csv")

```


```{r}
# Pie chart with plotly

# More info in https://plot.ly/r/pie-charts/
# Note: find how to animate it

```

```{r}
sach_polygon <- st_read(dsn = ".", layer = "no_ref_polygon") 

sach_polygon2 <- st_read(dsn = ".", layer = "ref_area_polygon") 
```


```{r}
# top 5 fastest growing species

tree_data$Height[is.na(tree_data$Height)] <- 0


top5_fastest <- tree_data %>% 
  filter( Year == 2020) %>%
  group_by(Species) %>% 
  summarize(av_height = mean(Height)) %>% 
  arrange( -av_height) %>% 
  head(10) 


top5_fastest$Species <- factor(top5_fastest$Species, levels = top5_fastest$Species)
  
graph_top5_fastest <- ggplot(top5_fastest, aes(x = Species, y = av_height)) + geom_bar(aes(fill=Species), stat="identity") +
  theme_classic() +
  scale_y_continuous(expand = c(0,0)) +
  xlab("Species") +
  ylab("Average Height (m)") +
  ggtitle("Top 5 Fastest Growing Species") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(legend.position="none")

graph_top5_fastest

```

```{r}
# top 5 slowest growing species

tree_data$Height[is.na(tree_data$Height)] <- 0


top5_slowest <- tree_data %>% 
  filter( Year == 2020) %>%
  group_by(Species) %>% 
  summarize(av_height = mean(Height)) %>% 
  arrange( av_height) %>% 
  head(10) 


top5_slowest$Species <- factor(top5_slowest$Species, levels = top5_slowest$Species)
  
graph_top5_slowest <- ggplot(top5_slowest, aes(x = Species, y = av_height)) + geom_bar(aes(fill=Species), stat="identity") +
  theme_classic() +
  scale_y_continuous(expand = c(0,0)) +
  xlab("Species") +
  ylab("Average Height (m)") +
  ggtitle("Top 5 Slowest Growing Species") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(legend.position="none")

graph_top5_slowest


```


